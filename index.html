<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Hypothesis Forge</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMiAzMiI+PGNpcmNsZSBjeD0iMTYiIGN5PSIxNiIgcj0iMTUiIGZpbGw9IiMyNTYzZWIiLz48cGF0aCBmaWxsPSIjZmZmIiBkPSJtMTYgNyAyIDcgNyAyLTcgMi0yIDctMi03LTctMiA3LTJaIi8+PC9zdmc+" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" crossorigin="anonymous" />
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@11.9.0/styles/github-dark.min.css" crossorigin="anonymous">
  <style>
    body {
      margin-bottom: 50vh;
    }

    .narrative {
      max-inline-size: 40rem;
    }

    .hljs {
      padding: 0.5rem;
    }

    .outcome.success h5 {
      color: var(--bs-success);
    }

    .outcome.failure h5 {
      color: var(--bs-danger);
    }

  </style>
</head>

<body>
  <nav class="navbar navbar-expand-lg bg-body-tertiary" data-bs-theme="dark">
    <div class="container-fluid">
      <a class="navbar-brand" href=".">Hypothesis Forge</a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <button class="dark-theme-toggle btn btn-primary dropdown-toggle ms-auto" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Open navigation menu">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-circle-half" viewBox="0 0 16 16">
            <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16" />
          </svg>
          <span class="d-lg-none ms-2">Toggle theme</span>
        </button>
        <ul class="dropdown-menu dropdown-menu-end">
          <li><button class="dropdown-item" data-bs-theme-value="light">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="me-2 bi bi-sun-fill" viewBox="0 0 16 16">
                <path d="M8 12a4 4 0 1 0 0-8 4 4 0 0 0 0 8M8 0a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 0m0 13a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-1 0v-2A.5.5 0 0 1 8 13m8-5a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2a.5.5 0 0 1 .5.5M3 8a.5.5 0 0 1-.5.5h-2a.5.5 0 0 1 0-1h2A.5.5 0 0 1 3 8m10.657-5.657a.5.5 0 0 1 0 .707l-1.414 1.415a.5.5 0 1 1-.707-.708l1.414-1.414a.5.5 0 0 1 .707 0m-9.193 9.193a.5.5 0 0 1 0 .707L3.05 13.657a.5.5 0 0 1-.707-.707l1.414-1.414a.5.5 0 0 1 .707 0m9.193 2.121a.5.5 0 0 1-.707 0l-1.414-1.414a.5.5 0 0 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .707M4.464 4.465a.5.5 0 0 1-.707 0L2.343 3.05a.5.5 0 1 1 .707-.707l1.414 1.414a.5.5 0 0 1 0 .708" />
              </svg>
              Light</button></li>
          <li><button class="dropdown-item" data-bs-theme-value="dark">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="me-2 bi bi-moon-stars-fill" viewBox="0 0 16 16">
                <path d="M6 .278a.77.77 0 0 1 .08.858 7.2 7.2 0 0 0-.878 3.46c0 4.021 3.278 7.277 7.318 7.277q.792-.001 1.533-.16a.79.79 0 0 1 .81.316.73.73 0 0 1-.031.893A8.35 8.35 0 0 1 8.344 16C3.734 16 0 12.286 0 7.71 0 4.266 2.114 1.312 5.124.06A.75.75 0 0 1 6 .278" />
                <path d="M10.794 3.148a.217.217 0 0 1 .412 0l.387 1.162c.173.518.579.924 1.097 1.097l1.162.387a.217.217 0 0 1 0 .412l-1.162.387a1.73 1.73 0 0 0-1.097 1.097l-.387 1.162a.217.217 0 0 1-.412 0l-.387-1.162A1.73 1.73 0 0 0 9.31 6.593l-1.162-.387a.217.217 0 0 1 0-.412l1.162-.387a1.73 1.73 0 0 0 1.097-1.097zM13.863.099a.145.145 0 0 1 .274 0l.258.774c.115.346.386.617.732.732l.774.258a.145.145 0 0 1 0 .274l-.774.258a1.16 1.16 0 0 0-.732.732l-.258.774a.145.145 0 0 1-.274 0l-.258-.774a1.16 1.16 0 0 0-.732-.732l-.774-.258a.145.145 0 0 1 0-.274l.774-.258c.346-.115.617-.386.732-.732z" />
              </svg>
              Dark</button></li>
          <li><button class="dropdown-item" data-bs-theme-value="auto">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="me-2 bi bi-circle-half" viewBox="0 0 16 16">
                <path d="M8 15A7 7 0 1 0 8 1zm0 1A8 8 0 1 1 8 0a8 8 0 0 1 0 16" />
              </svg>
              Auto</button></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container-fluid">
    <h1 class="display-1 my-4 text-center">Hypothesis Forge</h1>
    <h2 class="display-6 text-center">Automatically generate and test hypotheses on data</h2>
    <div class="mx-auto my-3 narrative">
      <p>Hypothesis Forge analyzes your data and generates hypotheses that you can test. Then it automatically tests them for you and gives you the results.</p>
    </div>

    <form id="hypoforge-settings" class="narrative mx-auto">
      <div class="my-4 p-4 card rounded-3 shadow-sm">
        <h2 class="h5">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-gear" viewBox="0 0 16 16">
            <path d="M8 4.754a3.246 3.246 0 1 0 0 6.492 3.246 3.246 0 0 0 0-6.492M5.754 8a2.246 2.246 0 1 1 4.492 0 2.246 2.246 0 0 1-4.492 0" />
            <path d="M9.796 1.343c-.527-1.79-3.065-1.79-3.592 0l-.094.319a.873.873 0 0 1-1.255.52l-.292-.16c-1.64-.892-3.433.902-2.54 2.541l.159.292a.873.873 0 0 1-.52 1.255l-.319.094c-1.79.527-1.79 3.065 0 3.592l.319.094a.873.873 0 0 1 .52 1.255l-.16.292c-.892 1.64.901 3.434 2.541 2.54l.292-.159a.873.873 0 0 1 1.255.52l.094.319c.527 1.79 3.065 1.79 3.592 0l.094-.319a.873.873 0 0 1 1.255-.52l.292.16c1.64.893 3.434-.902 2.54-2.541l-.159-.292a.873.873 0 0 1 .52-1.255l.319-.094c1.79-.527 1.79-3.065 0-3.592l-.319-.094a.873.873 0 0 1-.52-1.255l.16-.292c.893-1.64-.902-3.433-2.541-2.54l-.292.159a.873.873 0 0 1-1.255-.52zm-2.633.283c.246-.835 1.428-.835 1.674 0l.094.319a1.873 1.873 0 0 0 2.693 1.115l.291-.16c.764-.415 1.6.42 1.184 1.185l-.159.292a1.873 1.873 0 0 0 1.116 2.692l.318.094c.835.246.835 1.428 0 1.674l-.319.094a1.873 1.873 0 0 0-1.115 2.693l.16.291c.415.764-.42 1.6-1.185 1.184l-.291-.159a1.873 1.873 0 0 0-2.693 1.116l-.094.318c-.246.835-1.428.835-1.674 0l-.094-.319a1.873 1.873 0 0 0-2.692-1.115l-.292.16c-.764.415-1.6-.42-1.184-1.185l.159-.291A1.873 1.873 0 0 0 1.945 8.93l-.319-.094c-.835-.246-.835-1.428 0-1.674l.319-.094A1.873 1.873 0 0 0 3.06 4.377l-.16-.292c-.415-.764.42-1.6 1.185-1.184l.292.159a1.873 1.873 0 0 0 2.692-1.115z" />
          </svg>
          Settings
        </h2>

        <div class="accordion my-3" id="advancedSettings">
          <!-- API Key Setting -->
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#apiKeyCollapse" aria-expanded="false" aria-controls="apiKeyCollapse">
                <i class="bi bi-key me-2"></i>OpenAI API Key
              </button>
            </h2>
            <div id="apiKeyCollapse" class="accordion-collapse collapse" data-bs-parent="#advancedSettings">
              <div class="accordion-body">
                <div class="mb-3">
                  <label for="apiKeyInput" class="form-label">Enter your OpenAI API Key:</label>
                  <input type="password" class="form-control" id="apiKeyInput" placeholder="sk-...">
                  <div class="form-text">Your API key is stored locally in your browser and never sent to our servers.</div>
                </div>
              </div>
            </div>
          </div>

          <!-- Base URL Setting -->
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#baseUrlCollapse" aria-expanded="false" aria-controls="baseUrlCollapse">
                <i class="bi bi-key me-2"></i>Base URL
              </button>
            </h2>
            <div id="baseUrlCollapse" class="accordion-collapse collapse" data-bs-parent="#advancedSettings">
              <div class="accordion-body">
                <div class="mb-3">
                  <label for="baseUrlInput" class="form-label">Enter your OpenAI API Base URL:</label>
                  <input type="text" class="form-control" id="baseUrlInput" value="https://llmfoundry.straive.com/openai/v1" list="baseUrlList">
                  <datalist id="baseUrlList">
                    <option value="https://api.openai.com/v1"></option>
                    <option value="https://llmfoundry.straive.com/openai/v1"></option>
                    <option value="https://llmfoundry.straivedemo.com/openai/v1"></option>
                    <option value="https://openrouter.ai/api/v1" disabled></option>
                    <option value="https://aipipe.org/openai/v1" disabled></option>
                  </datalist>
                  <div class="form-text">Your API key is stored locally in your browser and never sent to our servers.</div>
                </div>
              </div>
            </div>
          </div>

          <!-- System Prompt Setting -->
          <div class="accordion-item">
            <h2 class="accordion-header">
              <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#systemPromptCollapse" aria-expanded="false" aria-controls="systemPromptCollapse">
                <i class="bi bi-chat-square-text me-2"></i>System Prompt &amp; Model
              </button>
            </h2>
            <div id="systemPromptCollapse" class="accordion-collapse collapse" data-bs-parent="#advancedSettings">
              <div class="accordion-body">
                <div class="mb-3">
                  <label for="hypothesis-prompt" class="form-label fw-bold">Hypothesis Generation Prompt</label>
                  <textarea id="hypothesis-prompt" class="form-control font-monospace" rows="5" placeholder="Enter custom prompt for hypothesis generation (optional)"></textarea>
                </div>
                <div class="mb-3">
                  <label for="analysis-prompt" class="form-label fw-bold">Analysis Prompt</label>
                  <textarea id="analysis-prompt" class="form-control font-monospace" rows="5" placeholder="Enter custom prompt for analysis (optional)">You are an expert data analyst. Test the given hypothesis on the provided Pandas DataFrame (df) as follows:

1. Create derived columns ONLY IF REQUIRED. E.g. If "CurrentMedication" contains "insulin", classify it as "Injectable", otherwise as "Pill".
2. If that's not possible, provide the best possible answer based on available data to the hypothesis, making assumptions.
3. Use the appropriate hypothesis test, e.g. t-test, chi-square, correlation significance test, etc.
4. Return the results as (success: bool, p_value: float)

Write the code as follows:

\`\`\`python
import pandas as pd
import scipy.stats as stats

def test_hypothesis(df) -> (bool, float):
    # use the imported modules to test the hypothesis
    return result, p_value
\`\`\`
</textarea>
                </div>
                <div class="mb-3">
                  <label for="model" class="form-label">Choose the model:</label>
                  <input type="text" class="form-control" id="model" value="gpt-4.1-mini" list="modelList">
                  <datalist id="modelList">
                    <option value="gpt-4.1-nano"></option>
                    <option value="gpt-4.1-mini"></option>
                    <option value="gpt-4.1"></option>
                    <option value="gpt-4o"></option>
                    <option value="o4-mini"></option>
                  </datalist>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </form>

    <div class="my-4" id="dataset-select">
      <div class="dropdown d-inline-block me-2">
        <button class="btn btn-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown" id="demo-dropdown">Sample datasets</button>
        <ul class="dropdown-menu list-group" id="demo-list"></ul>
      </div>
      <input type="file" class="form-control d-inline-block w-auto" id="file-input" accept=".csv,.sqlite,.db" />
    </div>
    <div id="preview" class="container-fluid"></div>
    <div id="context-section" class="container-fluid d-none">
      <textarea id="context" class="form-control my-2" rows="4"></textarea>
      <button type="button" class="btn btn-primary" id="generate-hypotheses">Generate hypotheses</button>
    </div>
    <div id="hypotheses" class="row row-cols-1 row-cols-sm-2 row-cols-lg-3 my-5 justify-content-center"></div>
    <div id="synthesis" class="d-none">
      <div class="text-center">
        <button type="button" class="btn btn-lg btn-warning mx-2" id="run-all">Test All</button>
        <button type="button" class="btn btn-lg btn-primary mx-2" id="synthesize">Summarize</button>
        <button type="button" class="btn btn-lg btn-danger mx-2" id="reset">Reset</button>
      </div>
      <div id="synthesis-result" class="mx-auto my-3 narrative"></div>
    </div>
    <div id="status"></div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" type="module"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap-dark-theme@1/dist/dark-theme.js"></script>
  <script src="script.js?v=1" type="module"></script>
</body>

</html>
